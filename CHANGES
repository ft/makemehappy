 User-visible changes in make-me-happy
=======================================

* v0.15 → v0.16 (unreleased):

** Breaking Compatibility:

- Configuration and source definitions inherit properties from layers with less
  priority. This means, that you cannot just override a definition. To remove
  any inherited data, use the new ‘remove’ top-level key.

** New Features

- Merge all yaml-stack layers after loading instead of doing it when required
  at ‘lookup’ time.
- Support removing specifications from lower priority files in the yaml stacks
  at merge-time.
- Allow adding configuration profiles to the config stack, using --config.
- Allow adding source definitions to the source stack, using --source.
- Implement loading west.yml after setting up zephyr-kernel module.
- Inherit west-based revisions specifications for zephyr modules, that do not
  specify a revision in a module's dependency list.
- Add a main-parameter to source definitions, specifying a module's main
  development branch.
- Implement revision-overrides by file-glob style patterns. This allows
  specifying a fixed revision or the use of a module's development branch.
- Implement revision-overrides by --revision option on the command line.
- Implement foo/bar/*/baz style instance filters for module builds.

** Bugfixes

- Process --query at a time where more information is established.

** Miscellaneous

- Removed a couple of obsolete zephyr modules: zephyr-hal-qmsi,
  zephyr-hal-unisoc and zephyr-mcumgr.

** Diffstat:

    ROADMAP.org              | 251 +++++++++++++++++++++++++++++++++++----
    _makemehappy             |   4 +-
    data/sources.yaml        |  37 +++++-
    makemehappy/cut.py       |  92 +++++++++++++-
    makemehappy/utilities.py |   7 ++
    makemehappy/yamlstack.py | 187 +++++++++++++++++++----------
    makemehappy/zephyr.py    |  37 ++++++
    mmh.in                   | 122 +++++++++++++------
    8 files changed, 602 insertions(+), 135 deletions(-)


* v0.14 → v0.15 (released 2022-12-19):

** New Features

- source: New zephyr-scilib module

** Bugfixes

- download-source: Use module name as destination for clone.
- fetch-dependencies: Error out if setting up a dependency fails.
- Fix component installation feature in module-builds.
- Error out if an unknown zephyr module is specified.

** Diffstat:

    data/sources.yaml     |  2 ++
    makemehappy/build.py  |  5 ++---
    makemehappy/cmake.py  | 11 +++++++++++
    makemehappy/cut.py    | 19 ++++++++++++++++---
    makemehappy/zephyr.py |  2 +-
    mmh.in                |  2 +-
    6 files changed, 33 insertions(+), 8 deletions(-)


* v0.13 → v0.14 (released 2022-11-02):

** New Features

- Allow selecting CMake components for installation. The ‘install’ key can be
  either ‘true’ or ‘false’ to enable/disable installation; when it is another
  string or a list of strings, mmh will trigger the names CMake components.
  This, for instance, works with ufw's ‘ufw-git-install’ component. But any
  other components your build declares will work as well.
- Add ‘--full’ option to ‘show-result’: This will output the entire data from a
  given log file stripping the per-line log-prefix.
- Add phase information to logging output as well.
- sources: Add ‘zephyr-picolibc’ module.
- sources: Add ‘ufwz’ module.

** Bugfixes

- Fix using ‘common’ section from ‘system.yaml’.
- show-phases: Force output after printing phase name.

** Diffstat:

    _makemehappy             |  1 +
    data/sources.yaml        |  4 ++++
    makemehappy/build.py     | 16 ++++++++++------
    makemehappy/cmake.py     |  4 +++-
    makemehappy/system.py    | 22 ++++++++++++++--------
    makemehappy/utilities.py | 24 ++++++++++++++++++++++--
    mmh.in                   | 11 +++++++++--
    7 files changed, 63 insertions(+), 19 deletions(-)


* v0.12 → v0.13 (released 2022-08-09):

** New Features

- Add top-level --show-phases option.
- Add top-level --succeed option.
- Add top-level ‘show-result’ command.

** Bugfixes

- Do not append to pre-existing log files, truncate first.

** Diffstat:

    _makemehappy              |  11 ++++
    makemehappy/build.py      |  21 +++++--
    makemehappy/loghandler.py |   3 +
    makemehappy/system.py     |  37 +++++++++---
    makemehappy/utilities.py  |   4 ++
    mmh.in                    | 115 ++++++++++++++++++++++++++++----------
    6 files changed, 145 insertions(+), 46 deletions(-)


* v0.11 → v0.12 (released 2022-06-24):

** New Features

- Add support for dtc-overlays in system and module builds.
- module: Allow zephyr instances to define application directory other than a
  repository's root-directory.

** Bugfixes

- system: Fix ‘clean’ subcommand.

** Diffstat:

    makemehappy/build.py  | 14 +++++++++++++-
    makemehappy/cmake.py  |  6 ++++--
    makemehappy/system.py |  2 ++
    3 files changed, 19 insertions(+), 3 deletions(-)


* v0.10 → v0.11 (released 2022-06-03):

** Breaking Compatibility:

- Removed ‘download’ alias for ‘download-source’. Use ‘get’ instead.
- Modules using ‘zephyr’ type now have to use ‘toolchains’ and ‘boards’ instead
  of ‘toolchain’ and ‘board’ for improved consistency with the new ‘system’
  sub-command's behaviour.
- Build-directories of modules now use slashes (/) as delimiters between
  instance parameters, like toolchain, build-config and the like. This is also
  to improve consistency with the build-directory trees used by the ‘system’
  command, but also removes the need for some ugly transfomations like
  replacing all underscores by dashes in zephyr board names.
- The ‘interface’ parameter for build instances was removed.
- This release requires the upcoming 2.0.0 version of ufw.

** New Features

- New ‘system’ sub-command: Building many instances of system pre-defined
  outside of mmh; for instance via git-submodules. This is a replacement for
  the recursive CMake execution scheme implemented by ufw in order to support
  more than one C/C++ toolchain in CMake.
- New zsh completion definition (compsys): _makemehappy.

** Bugfixes

- Fix installation step in systems that do not install any artefacts.
- Fix installation step in execution statistics.

** Diffstat:

    ROADMAP.org                         | 116 ++++++-
    _makemehappy                        | 303 +++++++++++++++++
    auto-configure                      |  40 +++
    data/config.yaml                    |   4 -
    doc/mmh.mdwn                        |   6 +-
    module.yaml => examples/module.yaml |   6 -
    examples/system.yaml                |  55 +++
    makemehappy/build.py                | 164 +++++----
    makemehappy/cmake.py                | 178 ++++++++++
    makemehappy/cut.py                  | 134 ++++++--
    makemehappy/system.py               | 497 ++++++++++++++++++++++++++++
    makemehappy/toplevel.py             |  27 +-
    makemehappy/utilities.py            |  64 ++--
    makemehappy/yamlstack.py            |   5 +-
    makemehappy/zephyr.py               |  50 +++
    mmh.in                              | 380 ++++++++++++++-------
    16 files changed, 1720 insertions(+), 309 deletions(-)


* v0.9 → v0.10 (released 2021-08-13):

** New Features

- Add ‘symlink’ source type.
- Add support for zephyr BOARD, DTS and SOC extensions in modules.

** Diffstat:

    makemehappy/cut.py      | 83 +++++++++++++++++++++++++++++++++++++----
    makemehappy/toplevel.py | 63 ++++++++++++++++++-------------
    mmh.in                  |  9 +++++
    3 files changed, 123 insertions(+), 32 deletions(-)


* v0.8 → v0.9 (released 2021-07-23):

** New Features

- Preliminary support for building applications based on Zephyr RTOS.
- Add lots of zephyr modules to ‘sources.yaml’.
- Allow module to call its ‘install’ target if desired.

** Bugfixes

- Improve ‘--help’ output for ‘--preserve’.

** Diffstat:

    data/sources.yaml       |  74 +++++++++++++++++++++++++++
    makemehappy/build.py    | 111 ++++++++++++++++++++++++++++++++++++----
    makemehappy/cut.py      |  10 ++++
    makemehappy/toplevel.py |  42 +++++++++++++--
    mmh.in                  |   4 +-
    5 files changed, 225 insertions(+), 16 deletions(-)


* v0.7 → v0.8 (released 2021-02-01):

** New Features

- Allow for ‘--force’/‘-F’ to override version data in MakeMeHappy.yaml.
- Allow ‘run’ to re-run specified build instances (experimental).
- Allow ‘architecture’ to be a list in ‘config.yaml’.
- Add ’cortex-m3’ to default architectures for ‘gnu-arm-none-eabi’.
- Add ‘download-source’ (aliases: ‘download’, ‘get’).

** Bugfixes

- Fix behaviour of ‘--architectures’ command line argument.
- Don't re-run unconfigured, if version check for MakeMeHappy.yaml fails.
- Typo and grammar fixes in documentation.

** Diffstat:

  LICENCE                  |   3 +-
  data/config.yaml         |   4 +-
  doc/Makefile             |   2 +-
  doc/mmh.mdwn             |  24 +++++-----
  makemehappy/build.py     | 100 ++++++++++++++++++++++++++++++++-------
  makemehappy/cut.py       |   9 ++++
  makemehappy/utilities.py |   2 +
  mmh.in                   |  76 ++++++++++++++++++++++-------
  8 files changed, 173 insertions(+), 47 deletions(-)


* v0.6 → v0.7 (released 2020-11-17):

** New Features

- Support ‘--toolchains’, ‘--buildtools’, ‘--buildconfigs’, ‘--architectures’
  and ‘--interfaces’.
- Add ‘show-source’ command (alias: ‘source’).
- Add ‘build-tree-init’ command (alias: ‘init’).
- Add ‘fetch-dependencies’ command (aliases: ‘fetch’, ‘deps’).
- Add ‘generate-toplevel’ command (alias: ‘top’).
- Add ‘run-instance’ command (alias: ‘run’).
- Add ‘reset-setup’ command (alias: ‘reset’).
- Support rebuilding instances.
- Support injecting CMake options into configuration call via command line.
- Add a ‘defaults’ variant of ‘variables’ that only takes effect if a value is
  not set yet when the top-level CMakefile executes.
- Add a little bit of documentation.
- Add ${cmake(CMAKE_VARIABLE_HERE)} to template expansions.
- Add ‘basic’ and ‘init’ generation steps.
- Add ‘cmake-extension-variants’ to use the same extension for multiple
  modules.
- Improved error reporting.

** Bugfixes

- Make some commands more resilient in case the build-directory is missing.
- Don't try to re-clone dependencies that already exist in ‘deps’.
- ‘module’ definitions in inclusion extensions are now optional.
- Fix ‘--source’, which never worked.

** Diffstat:

  ROADMAP.org              | 120 +++++++++++++++++++++++++++++--
  doc/Makefile             |  10 +--
  doc/mmh.mdwn             | 112 +++++++++++++++++++++++++++--
  makemehappy/build.py     |  63 +++++++++++-----
  makemehappy/buildroot.py |  10 ++-
  makemehappy/cut.py       | 111 +++++++++++++++++++++++++----
  makemehappy/toplevel.py  |  85 ++++++++++++++++++----
  makemehappy/utilities.py |  23 +++++-
  makemehappy/yamlstack.py |  54 ++++++++++++--
  mmh.in                   | 150 ++++++++++++++++++++++++++++++++++++---
  10 files changed, 663 insertions(+), 75 deletions(-)


* v0.5 → v0.6 (released 2020-10-27):

** Miscellaneous Changes

- Make git and the git repository optional dependencies when generating the mmh
  script.

** Diffstat:

 configure | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)


* v0.4 → v0.5 (released 2020-10-26):

** Miscellaneous Changes

- Use yaml.SafeLoader to avoid possible exploits.
- Move debian packaging to debian branch.

** Diffstat:

    debian/changelog         | 11 ---------
    debian/compat            |  1 -
    debian/control           | 20 ----------------
    debian/copyright         | 49 ----------------------------------------
    debian/rules             | 23 -------------------
    debian/source/format     |  1 -
    makemehappy/utilities.py |  2 +-
    7 files changed, 1 insertion(+), 106 deletions(-)


* v0.3 → v0.4 (released 2020-03-26):

** New Features

- Add ARM cmsis repository

- Add FreeRTOS repositories

- Add ST cmsis device support repositories

- Add ST device HAL repositories

- Add download-sources command that attempts to download all configured
  modules, respecting the definition stack.

** Diffstat:

    Makefile                 |  5 ++-
    data/sources.yaml        | 66 ++++++++++++++++++++++++++++++++++++++++
    debian/changelog         |  6 ++++
    makemehappy/utilities.py |  1 +
    mmh.in                   | 48 +++++++++++++++++++++++++++++
    5 files changed, 125 insertions(+), 1 deletion(-)


* v0.2 → v0.3 (released 2019-10-01):

** Breaking Compatibility:

- Rename "--buildcfgs" to "--buildconfigs" (f6021ca0).

- Rename "cmake-third-party" to "cmake-extension" (bca0cc1f).

** New Features:

- Adds "--query" to extract execution information (1c172525)

- "include" can now be boolean to avoid adding build-steps for a
  dependency (409c6fd1a).

- "include" now expands templates (0266dbe2).

- Add support for setting CMake variables in module definition (84c1ba8).

- Adds debian packaging information.

** Bugfixes:

- Fixes some invocations of "--log-to-file" (9c536f4c).

- Various cosmetic bug fixes in summary output.

** Diffstat:

    .gitignore               |   6 ++
    Makefile                 |  16 ++++-
    README                   |  22 +++++++
    debian/changelog         |   5 ++
    debian/compat            |   1 +
    debian/control           |  20 ++++++
    debian/copyright         |  49 +++++++++++++++
    debian/rules             |  23 +++++++
    debian/source/format     |   1 +
    etc/sources.yaml         |  95 +++++++++++++++++++++++++++-
    makemehappy/cut.py       | 125 ++++++++++++++++++++++++++++++++-----
    makemehappy/toplevel.py  | 130 +++++++++++++++++++--------------------
    makemehappy/utilities.py |  15 +++++
    makemehappy/yamlstack.py |  33 ++++++++++
    mmh.in                   |  60 +++++++++++++++++-
    module.yaml              |   5 +-
    16 files changed, 518 insertions(+), 88 deletions(-)


* v0.1 → v0.2 (released 2019-06-26):

** New Features:

- Execution statistics are gathered and summarised upon program termination
  (61a0483).

- Exit status now depends on the combined results of all build instances. Only
  if all instances succeed, does mmh return success (45c3f5b2).

- Tool definitions are now taken from configuration (however, modules can still
  override — a602f888).

- Handle output correctly; per default external programs don't push their
  output through logging facility. This can be forced, though. All output can
  also be dumped to file, in which case all output goes through the logging
  facility as well (63927123).

** Diffstat:

  ROADMAP.org               |  20 ++-
  data/config.yaml          |   7 +-
  makemehappy/build.py      |  64 +++++++---
  makemehappy/cut.py        | 247 ++++++++++++++++++++++++++++++++++++--
  makemehappy/loghandler.py |  38 ++++++
  makemehappy/utilities.py  |  15 ++-
  makemehappy/yamlstack.py  |  17 +++
  mmh.in                    |  62 ++++++++--
  sources.yaml              |  18 ---
  9 files changed, 416 insertions(+), 72 deletions(-)


* scratch → v0.1 (released 2019-06-17):

- First proof-of-concept that can build ufw

** Diffstat:

  .gitignore               |  18 ++++
  LICENCE                  |  25 +++++
  Makefile                 |  23 +++++
  ROADMAP.org              |  59 ++++++++++++
  configure                |  74 +++++++++++++++
  data/config.yaml         |  35 +++++++
  data/sources.yaml        |   5 +
  doc/Makefile             |  37 ++++++++
  doc/manual.css           |  75 +++++++++++++++
  doc/mmh.mdwn             |  44 +++++++++
  doc/template.latex       | 157 ++++++++++++++++++++++++++++++
  etc/config.yaml          |   2 +
  etc/sources.yaml         |   2 +
  makemehappy/build.py     | 106 +++++++++++++++++++++
  makemehappy/buildroot.py |  65 +++++++++++++
  makemehappy/cut.py       | 216 ++++++++++++++++++++++++++++++++++++++++++
  makemehappy/module.py    |   4 +
  makemehappy/toplevel.py  |  86 +++++++++++++++++
  makemehappy/utilities.py |  79 +++++++++++++++
  makemehappy/yamlstack.py |  38 ++++++++
  mmh.in                   | 123 ++++++++++++++++++++++++
  module.yaml              |  42 ++++++++
  sources.yaml             |  18 ++++
  23 files changed, 1333 insertions(+)
